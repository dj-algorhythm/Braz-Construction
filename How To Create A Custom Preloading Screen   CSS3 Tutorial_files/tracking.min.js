jQuery(document).ready(function(e){function i(t){e.cookie("affwp_ref",t,{expires:AFFWP.expiration,path:"/"});e.ajax({type:"POST",data:{action:"affwp_track_visit",affiliate:t,url:document.URL,referrer:document.referrer},url:affwp_scripts.ajaxurl,success:function(t){e.cookie("affwp_ref_visit_id",t,{expires:AFFWP.expiration,path:"/"})}}).fail(function(e){if(window.console&&window.console.log){console.log(e)}})}function s(){var e=[],t;var n=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");for(var r=0;r<n.length;r++){t=n[r].split("=");e.push(t[0]);e[t[0]]=t[1]}return e}var t=e.cookie("affwp_ref");if(t){return}var n=s()[AFFWP.referral_var];if(typeof n=="undefined"){var r=window.location.pathname.split("/");e.each(r,function(e,t){if(AFFWP.referral_var==t){n=r[e+1]}})}if(!e.isNumeric(n)){e.ajax({type:"POST",data:{action:"affwp_get_affiliate_id",affiliate:n},url:affwp_scripts.ajaxurl,success:function(e){console.log(e);if("1"==e.data.success){i(e.data.affiliate_id)}}}).fail(function(e){if(window.console&&window.console.log){console.log(e)}})}else{if(n&&!t){i(n)}}})